from math import sin, cos, atan
from khafid_fungsi import *
from elp2000_1 import *


def ELP82B(tjj, R):
    Xe = Xe + ELP01_001() + ELP01_002() + ELP01_003() + ELP01_004() + ELP01_005() + ELP01_006() + ELP01_007()
    Xe = Xe + ELP01_008() + ELP01_009() + ELP01_010() + ELP01_011() + ELP01_012() + ELP01_013() + ELP34_001()
    Xe = Xe + ELP04_001() + ELP04_002() + ELP04_003() + ELP04_004() + ELP04_005() + ELP07_001() + ELP22_001()
    Xe = Xe + ELP10_001() + ELP10_002() + ELP10_003() + ELP10_004() + ELP10_005() + ELP10_006() + ELP10_007()
    Xe = Xe + ELP10_008() + ELP10_009() + ELP10_010() + ELP10_011() + ELP10_012() + ELP10_013() + ELP10_014()
    Xe = Xe + ELP10_015() + ELP10_016() + ELP10_017() + ELP10_018() + ELP10_019() + ELP10_020() + ELP10_021()
    Xe = Xe + ELP10_022() + ELP10_023() + ELP10_024() + ELP10_025() + ELP10_026() + ELP10_027() + ELP10_028()
    Xe = Xe + ELP10_029() + ELP10_030() + ELP10_031() + ELP10_032() + ELP10_033() + ELP10_034() + ELP10_035()
    Xe = Xe + ELP10_036() + ELP10_037() + ELP10_038() + ELP10_039() + ELP10_040() + ELP10_041() + ELP10_042()
    Xe = Xe + ELP10_043() + ELP10_044() + ELP10_045() + ELP10_046() + ELP10_047() + ELP10_048() + ELP10_049()
    Xe = Xe + ELP10_050() + ELP10_051() + ELP10_052() + ELP10_053() + ELP10_054() + ELP10_055() + ELP10_056()
    Xe = Xe + ELP10_057() + ELP10_058() + ELP10_059() + ELP10_060() + ELP10_061() + ELP10_062() + ELP10_063()
    Xe = Xe + ELP10_064() + ELP10_065() + ELP10_066() + ELP10_067() + ELP10_068() + ELP10_069() + ELP10_070()
    Xe = Xe + ELP10_071() + ELP10_072() + ELP10_073() + ELP10_074() + ELP10_075() + ELP10_076() + ELP10_077()
    Xe = Xe + ELP10_078() + ELP10_079() + ELP10_080() + ELP10_081() + ELP10_082() + ELP10_083() + ELP10_084()
    Xe = Xe + ELP10_085() + ELP10_086() + ELP10_087() + ELP10_088() + ELP10_089() + ELP10_090() + ELP10_091()
    Xe = Xe + ELP10_092() + ELP10_093() + ELP10_094() + ELP10_095() + ELP10_096() + ELP10_097() + ELP10_098()
    Xe = Xe + ELP10_099() + ELP10_100() + ELP10_101() + ELP10_102() + ELP10_103() + ELP10_104() + ELP10_105()
    Xe = Xe + ELP10_106() + ELP10_107() + ELP10_108() + ELP10_109() + ELP10_110() + ELP10_111() + ELP10_112()
    Xe = Xe + ELP10_113() + ELP10_114() + ELP10_115() + ELP10_116() + ELP10_117() + ELP10_118() + ELP10_119()
    Xe = Xe + ELP10_120() + ELP10_121() + ELP10_122() + ELP10_123() + ELP10_124() + ELP10_125() + ELP10_126()
    Xe = Xe + ELP10_127() + ELP10_128() + ELP10_129() + ELP10_130() + ELP10_131() + ELP10_132() + ELP10_133()
    Xe = Xe + ELP10_134() + ELP10_135() + ELP10_136() + ELP10_137() + ELP10_138() + ELP10_139() + ELP10_140()
    Xe = Xe + ELP10_141() + ELP10_142() + ELP10_143() + ELP10_144() + ELP10_145() + ELP10_146() + ELP10_147()
    Xe = Xe + ELP10_148() + ELP10_149() + ELP10_150() + ELP10_151() + ELP10_152() + ELP10_153() + ELP10_154()
    Xe = Xe + ELP10_155() + ELP10_156() + ELP10_157() + ELP10_158() + ELP10_159() + ELP10_160() + ELP10_161()
    Xe = Xe + ELP10_162() + ELP10_163() + ELP10_164() + ELP10_165() + ELP10_166() + ELP10_167() + ELP10_168()
    Xe = Xe + ELP10_169() + ELP10_170() + ELP10_171() + ELP10_172() + ELP10_173() + ELP10_174() + ELP10_175()
    Xe = Xe + ELP10_176() + ELP10_177() + ELP10_178() + ELP10_179() + ELP10_180() + ELP28_001() + ELP31_001()
    Xe = Xe + ELP13_001() + ELP13_002() + ELP13_003() + ELP13_004() + ELP13_005() + ELP13_006() + ELP13_007()
    Xe = Xe + ELP13_008() + ELP13_009() + ELP13_010() + ELP13_011() + ELP13_012() + ELP13_013() + ELP13_014()
    Xe = Xe + ELP13_015() + ELP13_016() + ELP13_017() + ELP13_018() + ELP13_019() + ELP13_020() + ELP13_021()
    Xe = Xe + ELP13_022() + ELP13_023() + ELP13_024() + ELP13_025() + ELP13_026() + ELP13_027() + ELP13_028()
    Xe = Xe + ELP13_029() + ELP13_030() + ELP13_031() + ELP13_032() + ELP13_033() + ELP13_034() + ELP13_035()
    Xe = Xe + ELP13_036() + ELP13_037() + ELP13_038() + ELP13_039() + ELP13_040() + ELP13_041() + ELP13_042()
    Xe = Xe + ELP13_043() + ELP13_044() + ELP13_045() + ELP13_046() + ELP13_047() + ELP13_048() + ELP13_049()
    Xe = Xe + ELP13_050() + ELP13_051() + ELP13_052() + ELP13_053() + ELP13_054() + ELP13_055() + ELP25_001()
    Xe = Xe + ELP16_001() + ELP16_002() + ELP16_003() + ELP19_001() + ELP19_002() + ELP19_003()
    
    Ye = Ye + ELP02_001() + ELP02_002() + ELP02_003() + ELP02_004() + ELP02_005() + ELP02_006() + ELP02_007()
    Ye = Ye + ELP02_008() + ELP02_009() + ELP02_010() + ELP02_011() + ELP02_012() + ELP32_001() + ELP35_001()
    Ye = Ye + ELP05_001() + ELP05_002() + ELP05_003() + ELP05_004() + ELP08_001() + ELP29_001() + ELP26_001()
    Ye = Ye + ELP11_001() + ELP11_002() + ELP11_003() + ELP11_004() + ELP11_005() + ELP11_006() + ELP11_007()
    Ye = Ye + ELP11_008() + ELP11_009() + ELP11_010() + ELP11_011() + ELP11_012() + ELP11_013() + ELP11_014()
    Ye = Ye + ELP11_015() + ELP11_016() + ELP11_017() + ELP11_018() + ELP11_019() + ELP11_020() + ELP11_021()
    Ye = Ye + ELP11_022() + ELP11_023() + ELP11_024() + ELP11_025() + ELP11_026() + ELP11_027() + ELP11_028()
    Ye = Ye + ELP11_029() + ELP11_030() + ELP11_031() + ELP11_032() + ELP11_033() + ELP11_034() + ELP11_035()
    Ye = Ye + ELP11_036() + ELP11_037() + ELP11_038() + ELP11_039() + ELP11_040() + ELP11_041() + ELP11_042()
    Ye = Ye + ELP11_043() + ELP11_044() + ELP11_045() + ELP11_046() + ELP11_047() + ELP11_048() + ELP11_049()
    Ye = Ye + ELP11_050() + ELP11_051() + ELP11_052() + ELP11_053() + ELP11_054() + ELP11_055() + ELP11_056()
    Ye = Ye + ELP11_057() + ELP11_058() + ELP11_059() + ELP11_060() + ELP11_061() + ELP11_062() + ELP11_063()
    Ye = Ye + ELP11_064() + ELP11_065() + ELP11_066() + ELP14_001() + ELP14_002() + ELP14_003() + ELP14_004()
    Ye = Ye + ELP14_005() + ELP14_006() + ELP14_007() + ELP14_008() + ELP14_009() + ELP14_010() + ELP14_011()
    Ye = Ye + ELP17_001() + ELP17_002() + ELP20_001() + ELP20_002() + ELP20_003() + ELP23_001()

    Ze = Ze + ELP03_001() + ELP03_002() + ELP03_003() + ELP03_004() + ELP03_005() + ELP03_006() + ELP03_007()
    Ze = Ze + ELP03_008() + ELP03_009() + ELP06_001() + ELP06_002() + ELP06_003() + ELP09_001() + ELP33_001()
    Ze = Ze + ELP12_001() + ELP12_002() + ELP12_003() + ELP12_004() + ELP12_005() + ELP12_006() + ELP12_007()
    Ze = Ze + ELP12_008() + ELP12_009() + ELP12_010() + ELP12_011() + ELP12_012() + ELP12_013() + ELP12_014()
    Ze = Ze + ELP12_015() + ELP12_016() + ELP12_017() + ELP12_018() + ELP12_019() + ELP12_020() + ELP12_021()
    Ze = Ze + ELP12_022() + ELP12_023() + ELP12_024() + ELP12_025() + ELP12_026() + ELP12_027() + ELP12_028()
    Ze = Ze + ELP12_029() + ELP12_030() + ELP12_031() + ELP12_032() + ELP12_033() + ELP12_034() + ELP12_035()
    Ze = Ze + ELP12_036() + ELP12_037() + ELP12_038() + ELP12_039() + ELP12_040() + ELP12_041() + ELP12_042()
    Ze = Ze + ELP12_043() + ELP12_044() + ELP12_045() + ELP12_046() + ELP12_047() + ELP12_048() + ELP12_049()
    Ze = Ze + ELP12_050() + ELP12_051() + ELP12_052() + ELP12_053() + ELP12_054() + ELP12_055() + ELP12_056()
    Ze = Ze + ELP12_057() + ELP12_058() + ELP12_059() + ELP12_060() + ELP12_061() + ELP12_062() + ELP12_063()
    Ze = Ze + ELP12_064() + ELP12_065() + ELP12_066() + ELP12_067() + ELP12_068() + ELP12_069() + ELP12_070()
    Ze = Ze + ELP12_071() + ELP12_072() + ELP12_073() + ELP12_074() + ELP12_075() + ELP12_076() + ELP12_077()
    Ze = Ze + ELP12_078() + ELP12_079() + ELP12_080() + ELP12_081() + ELP12_082() + ELP12_083() + ELP36_001()
    Ze = Ze + ELP15_001() + ELP15_002() + ELP15_003() + ELP15_004() + ELP15_005() + ELP15_006() + ELP15_007()
    Ze = Ze + ELP15_008() + ELP15_009() + ELP15_010() + ELP15_011() + ELP15_012() + ELP15_013() + ELP15_014()
    Ze = Ze + ELP15_015() + ELP15_016() + ELP15_017() + ELP15_018() + ELP15_019() + ELP15_020() + ELP15_021()
    Ze = Ze + ELP15_022() + ELP18_001() + ELP18_002() + ELP21_001() + ELP21_002() + ELP21_003() + ELP24_001()
    Ze = Ze + ELP27_001() + ELP30_001()

    Xe = Xe / rad + w[0][0] + w[0][1] * T2 + w[0][2] * T3 + w[0][3] * T4 + w[0][6] * T5
    Ye = Ye / rad
    Ze = Ze * a0 / ath
    X1 = Ze * cos(Ye)
    X2 = X1 * sin(Xe)
    X1 = X1 * cos(Xe)
    X3 = Ze * sin(Ye)
    pw = (p1 + p2 * T2 + p3 * T3 + p4 * T4 + p5 * T5) * T2
    qw = (q1 + q2 * T2 + q3 * T3 + q4 * T4 + q5 * T5) * T2
    RA = 2 * sqrt(1 - pw * pw - qw * qw)
    pwqw = 2 * pw * qw
    pw2 = 1 - 2 * pw * pw
    qw2 = 1 - 2 * qw * qw
    pw = pw * RA
    qw = qw * RA
    #R[0] = 
    R = [pw2 * X1 + pwqw * X2 + pw * X3, pwqw * X1 + qw2 * X2 - qw * X3, -pw * X1 + qw * X2 + (pw2 + qw2 - 1) * X3]

    print(R)


def initialisasi_elements1(tjj):
    cpi = 4 * atan(1)
    cpi2 = 2 * cpi
    pis2 = cpi / 2
        
    rad = 648000 / cpi
    deg = cpi / 180
    c1 = 60
    c2 = 3600
    ath = 384747.980674317
    a0 = 384747.980644895
    am = 0.074801329518
    alfa = 0.002571881335
    dtasm = 2 * alfa / (3 * am)

#   Lunar arguments.
    w[0][0] = (218 + 18 / c1 + 59.95571 / c2) * deg
    w[1][0] = (83 + 21 / c1 + 11.67475 / c2) * deg
    w[2][0] = (125 + 2 / c1 + 40.39816 / c2) * deg
    eart[0] = (100 + 27 / c1 + 59.22059 / c2) * deg
    peri[0] = (102 + 56 / c1 + 14.42753 / c2) * deg
    w[0][1] = 1732559343.73604 / rad
    w[1][1] = 14643420.2632 / rad
    w[2][1] = -6967919.3622 / rad
    eart(2) = 129597742.2758 / rad
    peri(2) = 1161.2283 / rad
    w(1, 3) = -5.8883 / rad
    w(2, 3) = -38.2776 / rad
    w(3, 3) = 6.3622 / rad
    eart(3) = -0.0202 / rad
    peri(3) = 0.5327 / rad
    w(1, 4) = 0.006604 / rad
    w(2, 4) = -0.045047 / rad
    w(3, 4) = 0.007625 / rad
    eart(4) = 0.000009 / rad
    peri(4) = -0.000138 / rad
    w(1, 5) = -0.00003169 / rad
    w(2, 5) = 0.00021301 / rad
    w(3, 5) = -0.00003586 / rad
    eart(5) = 0.00000015 / rad
    peri(5) = 0

#   Planetary arguments.
    preces = 5029.0966 / rad
    p11 = (252 + 15 / c1 + 3.25986 / c2) * deg
    p21 = (181 + 58 / c1 + 47.28305 / c2) * deg
    p31 = eart(1)
    p41 = (355 + 25 / c1 + 59.78866 / c2) * deg
    p51 = (34 + 21 / c1 + 5.34212 / c2) * deg
    p61 = (50 + 4 / c1 + 38.89694 / c2) * deg
    p71 = (314 + 3 / c1 + 18.01841 / c2) * deg
    p81 = (304 + 20 / c1 + 55.19575 / c2) * deg
    p12 = 538101628.68898 / rad
    p22 = 210664136.43355 / rad
    p32 = eart(2)
    p42 = 68905077.59284 / rad
    p52 = 10925660.42861 / rad
    p62 = 4399609.65932 / rad
    p72 = 1542481.19393 / rad
    p82 = 786550.32074 / rad

#   Corrections of the constants (fit to DE200/LE200).
    delnu = 0.55604 / rad / w(1, 2)
    dele = 0.01789 / rad
    delg = -0.08066 / rad
    delnp = -0.06424 / rad / w(1, 2)
    delep = -0.12879 / rad

#   Delaunay's arguments.
    d11 = w(1, 1) - eart(1)
    d41 = w(1, 1) - w(3, 1)
    d31 = w(1, 1) - w(2, 1)
    d21 = eart(1) - peri(1)
    d12 = w(1, 2) - eart(2)
    d42 = w(1, 2) - w(3, 2)
    d32 = w(1, 2) - w(2, 2)
    d22 = eart(2) - peri(2)
    d13 = w(1, 3) - eart(3)
    d43 = w(1, 3) - w(3, 3)
    d33 = w(1, 3) - w(2, 3)
    d23 = eart(3) - peri(3)
    d14 = w(1, 4) - eart(4)
    d44 = w(1, 4) - w(3, 4)
    d34 = w(1, 4) - w(2, 4)
    d24 = eart(4) - peri(4)
    d15 = w(1, 5) - eart(5)
    d45 = w(1, 5) - w(3, 5)
    d35 = w(1, 5) - w(2, 5)
    d25 = eart(5) - peri(5)
    
    
    d11 = d11 + cpi
    z1 = w(1, 1)
    z2 = w(1, 2) + preces

#    Precession matrix.
    p1 = 0.000010180391
    p2 = 0.00000047020439
    p3 = -5.417367E-10
    p4 = -2.507948E-12
    p5 = 4.63486E-15
    q1 = -0.000113469002
    q2 = 0.00000012372674
    q3 = 0.000000001265417
    q4 = -1.371808E-12
    q5 = -3.20334E-15

    T1 = 1
    T2 = (tjj - 2451545) / 36525
    T3 = T2 * T2
    T4 = T3 * T2
    T5 = T4 * T2




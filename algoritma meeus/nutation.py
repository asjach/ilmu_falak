from math import radians, cos, sin

class Nutation:
    def __init__(self, t_td):
        self.t = t_td
        t = t_td
        self.d = radians((297.85036 + 445267.11148*t - 0.0019142*t**2 + t**3/189474) % 360)
        self.m = radians((357.52772 + 35999.05034*t - 0.0001603*t*t - t*t*t/300000) % 360)
        self.m_aksen = radians((134.96298 + 477198.867398*t + 0.0086972*t*t + t*t*t/56250) % 360)
        self.f = radians((93.27191 + 483202.017538*t - 0.0036825*t*t + t*t*t/327270) % 360)
        self.omega = radians((125.04452 - 1934.136261*t + 0.0020708*t*t + t*t*t/450000) % 360)

    @property
    def epsilon(self):
        hasil = radians(self.epsilon_zero + (self.delta_epsilon_total)/3600)
        return hasil
    
    @property
    def epsilon_zero(self):
        t = self.t
        u = t/100
        hasil =  23 + 26/60 + 21.448/3600 + (-4680.93*u - 1.55*u**2 + 1999.25*u**3 - 51.38*u**4 - 249.67*u**5 - 39.05*u**6+ 7.12*u**7 + 27.87*u**8 + 5.79*u**9 + 2.45*u**10)/3600
        return hasil
    
    @property
    def delta_epsilon_total(self):
        t = self.t
        d = self.d
        m = self.m
        m_aksen = self.m_aksen
        f = self.f
        omega = self.omega

        total = 0
        for i in range(len(delta_epsilon)):
            total += (delta_epsilon[i][5] + delta_epsilon[i][6]*t) * cos(delta_epsilon[i][0] * d + delta_epsilon[i][1] * m + delta_epsilon[i][2] * m_aksen + delta_epsilon[i][3] * f + delta_epsilon[i][4] * omega)
        return total/10000

    @property
    def delta_psi(self):
        hasil = self.delta_psi_total/3600
        return hasil

    @property
    def delta_psi_total(self):
        t = self.t
        d = self.d
        m = self.m
        m_aksen = self.m_aksen
        f = self.f
        omega = self.omega
        total = 0
        for i in range(len(Delta_Psi)):
            total += (Delta_Psi[i][5] + Delta_Psi[i][6]*t) * sin(Delta_Psi[i][0] * d + Delta_Psi[i][1] * m + Delta_Psi[i][2] * m_aksen + Delta_Psi[i][3] * f + Delta_Psi[i][4] * omega)
        return total/10000

        pass
            
delta_epsilon = [
    [0, 0, 0, 0, 1, 92025, 8.9],
    [-2, 0, 0, 2, 2, 5736, -3.1],
    [0, 0, 0, 2, 2, 977, -0.5],
    [0, 0, 0, 0, 2, -895, 0.5],
    [0, 1, 0, 0, 0, 54, -0.1],
    [-2, 1, 0, 2, 2, 224, -0.6],
    [0, 0, 1, 2, 2, 129, -0.1],
    [-2, -1, 0, 2, 2, -95, 0.3],
    [0, 0, 1, 0, 0, -7, 0],
    [0, 0, 0, 2, 1, 200, 0],
    [-2, 0, 0, 2, 1, -70, 0],
    [0, 0, -1, 2, 2, -53, 0],
    [0, 0, 1, 0, 1, -33, 0],
    [2, 0, -1, 2, 2, 26, 0],
    [0, 0, -1, 0, 1, 32, 0],
    [0, 0, 1, 2, 1, 27, 0],
    [0, 0, -2, 2, 1, -24, 0],
    [2, 0, 0, 2, 2, 16, 0],
    [0, 0, 2, 2, 2, 13, 0],
    [-2, 0, 1, 2, 2, -12, 0],
    [0, 0, -1, 2, 1, -10, 0],
    [2, 0, -1, 0, 1, -8, 0],
    [-2, 2, 0, 2, 2, 7, 0],
    [0, 1, 0, 0, 1, 9, 0],
    [-2, 0, 1, 0, 1, 7, 0],
    [0, -1, 0, 0, 1, 6, 0],
    [2, 0, -1, 2, 1, 5, 0],
    [2, 0, 1, 2, 2, 3, 0],
    [0, 1, 0, 2, 2, -3, 0],
    [0, -1, 0, 2, 2, 3, 0],
    [2, 0, 0, 2, 1, 3, 0],
    [-2, 0, 2, 2, 2, -3, 0],
    [-2, 0, 1, 2, 1, -3, 0],
    [2, 0, -2, 0, 1, 3, 0],
    [2, 0, 0, 0, 1, 3, 0],
    [-2, -1, 0, 2, 1, 3, 0],
    [-2, 0, 0, 0, 1, 3, 0],
    [0, 0, 2, 2, 1, 3, 0],
]

# delta psi (nutasi)
Delta_Psi = [
    [0, 0, 0, 0, 1, -171996, -174.2],
    [-2, 0, 0, 2, 2, -13187, -1.6],
    [0, 0, 0, 2, 2, -2274, -0.2],
    [0, 0, 0, 0, 2, 2062, 0.2],
    [0, 1, 0, 0, 0, 1426, -3.4],
    [0, 0, 1, 0, 0, 712, 0.1],
    [-2, 1, 0, 2, 2, -517, 1.2],
    [0, 0, 0, 2, 1, -386, -0.4],
    [-2, -1, 0, 2, 2, 217, -0.5],
    [-2, 0, 0, 2, 1, 129, 0.1],
    [0, 0, 1, 0, 1, 63, 0.1],
    [0, 0, -1, 0, 1, -58, -0.1],
    [0, 2, 0, 0, 0, 17, -0.1],
    [-2, 2, 0, 2, 2, -16, 0.1],
    [0, 0, 1, 2, 2, -301, 0],
    [-2, 0, 1, 0, 0, -158, 0],
    [0, 0, -1, 2, 2, 123, 0],
    [2, 0, 0, 0, 0, 63, 0],
    [2, 0, -1, 2, 2, -59, 0],
    [0, 0, 1, 2, 1, -51, 0],
    [-2, 0, 2, 0, 0, 48, 0],
    [0, 0, -2, 2, 1, 46, 0],
    [2, 0, 0, 2, 2, -38, 0],
    [0, 0, 2, 2, 2, -31, 0],
    [0, 0, 2, 0, 0, 29, 0],
    [-2, 0, 1, 2, 2, 29, 0],
    [0, 0, 0, 2, 0, 26, 0],
    [-2, 0, 0, 2, 0, -22, 0],
    [0, 0, -1, 2, 1, 21, 0],
    [2, 0, -1, 0, 1, 16, 0],
    [0, 1, 0, 0, 1, -15, 0],
    [-2, 0, 1, 0, 1, -13, 0],
    [0, -1, 0, 0, 1, -12, 0],
    [0, 0, 2, -2, 0, 11, 0],
    [2, 0, -1, 2, 1, -10, 0],
    [2, 0, 1, 2, 2, -8, 0],
    [0, 1, 0, 2, 2, 7, 0],
    [-2, 1, 1, 0, 0, -7, 0],
    [0, -1, 0, 2, 2, -7, 0],
    [2, 0, 0, 2, 1, -7, 0],
    [2, 0, 1, 0, 0, 6, 0],
    [-2, 0, 2, 2, 2, 6, 0],
    [-2, 0, 1, 2, 1, 6, 0],
    [2, 0, -2, 0, 1, -6, 0],
    [2, 0, 0, 0, 1, -6, 0],
    [0, -1, 1, 0, 0, 5, 0],
    [-2, -1, 0, 2, 1, -5, 0],
    [-2, 0, 0, 0, 1, -5, 0],
    [0, 0, 2, 2, 1, -5, 0],
    [-2, 0, 2, 0, 1, 4, 0],
    [-2, 1, 0, 2, 1, 4, 0],
    [0, 0, 1, -2, 0, 4, 0],
    [-1, 0, 1, 0, 0, -4, 0],
    [-2, 1, 0, 0, 0, -4, 0],
    [1, 0, 0, 0, 0, -4, 0],
    [0, 0, 1, 2, 0, 3, 0],
    [0, 0, -2, 2, 2, -3, 0],
    [-1, -1, 1, 0, 0, -3, 0],
    [0, 1, 1, 0, 0, -3, 0],
    [0, -1, 1, 2, 2, -3, 0],
    [2, -1, -1, 2, 2, -3, 0],
    [0, 0, 3, 2, 2, -3, 0],
    [2, -1, 0, 2, 2, -3, 0]
]